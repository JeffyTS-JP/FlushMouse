= [[ProjectName]] 

[[RepositoryInfo]]

||[[Thumb(FlushMouse.png, size=48x48)]]||'''[[ProjectDescription]](タスクトレイに常駐して、マウスカーソルへIMEモードの表示をするユーティリティです)[[BR]]FlushMouse is a software developed by JeffyTS . It is a mouse gesture tool that allows you to perform various operations by drawing gestures with your mouse .  (by Bing ChatGPT)'''||

[[BR]]
2023/04/16[[BR]]
　　　Version 0.9.4.11 をリリースしました[[BR]]
[[BR]]
(主な変更点)[[BR]]
 * バグ修正と、インストーラーの修正を行いました[[BR]]
 * IMEモードの表示の色指定でαチャネルが有効になるように変更しました(設定画面は作成していません。レジストリを編集できる方は好みの色にしてみてください。ただし、レジストリの編集は十分注意して行ってください)[[BR]]
   * HKEY_CURRENT_USER\Software\JeffyTS\FlushMouse の NearDrawCaretColor と NearDrawMouseColor です。上位バイトから、α B G R の順です[[BR]]
   * マウスカーソル右下のモード表示の色は、現状では変更できません。ご了承ください[[BR]]
[[BR]]
(今後について)[[BR]]
 * OSDN上ではここまでの機能で開発は終了としたいと考えています(バグ対応は除く)[[BR]]
 * 今後は、プレゼンテーションモードの追加や、マウスカーソルの形状や、表示する内容などをカスタマイズする機能をつけて有償に移行しようと考えています[[BR]]
[[BR]]
||'''対応OS'''||
Windows 10 / 11 64bit  (Latest Release Versionで検証しています)[[BR]]
[[BR]]
||'''インストール'''||
Windows Installer (msi)形式になっています。実行してインストールしてください[[BR]]
[[BR]]
アンインストールは「設定」の「アプリと機能」、または「コントロールパネル」の「プログラムと機能」からできます[[BR]]
または、同じバージョンのインストーラーがあればそれをもう一度実行してもアンインストールできます[[BR]]
　　こちらの場合は、本プログラムの設定(レジストリ)を削除するかどうかを選べます(デフォルトでは残すようにしてあります)[[BR]]
[[BR]]

||'''使い方'''||
スタートメニュー、デスクトップのアイコンをクリックするか、PCを起動するとタスクトレイに常駐します[[BR]]
　　(ただし、PC再起動で起動しないと、一部のアプリでモード表示されない現象が発生します)[[BR]]
[[BR]]
 * 不要であればデスクトップのショートカットアイコンは、削除してしまっても問題ありません[[BR]]
 * PC起動時に、タスクスケジューラーからFlushMouseを起動するようになっています[[BR]]
   (これにより、以前の制限事項であった「一部のアプリ、例えば「タスクマネージャー」などがフォーカスを持っているときは、モード表示ができません」は解消されました)[[BR]]

[[BR]]
||'''マウスカーソル'''||
 * IME ONの時にモードを表示するマウスカーソルは、「矢印(通常の選択)」「Ｉビーム(テキスト選択)」「ハンド(リンクの選択)」の3種類です[[BR]]
 * IME OFF(直接入力)ではマウスカーソル左にはモードを表示しません(キャレットのモード表示は行います)[[BR]]
 * キャレットとマウスカーソル左へのIMEモード表示に、Caps Lock ONの時はアンダーラインを表示します (マウスカーソル右下の表示にはアンダーラインは表示されません。ご了承ください)[[BR]]
[[BR]]
[[Thumb(Cursors.png, size=230x181)]]
[[BR]]
||'''設定ダイアログ画面'''||
[[Thumb(SettingDlg.png, size=572x645)]]
[[BR]][[BR]]

'''設定のヒント'''[[BR]]
[[BR]]
Windows 10 / 11ではマウスカーソルの形状や大きさを決める方法が複数あるため、下記の順番で設定することをお勧めします[[BR]]
[[BR]]
 1. 設定→ディスプレイ→拡大縮小とレイアウトで、「ディスプレイの解像度」、「テキスト、アプリ、その他の項目のサイズ」、「表示スケールの詳細設定」を好みに設定します[[BR]]
 2. 設定→デバイス→マウス→「マウスとカーソルのサイズを調整する」で好みに設定します[[BR]]
    * この変更を行うとマウスカーソルが、Windows 10 / 11特有のものになります[[BR]]
    * もし、Windows 7などの以前のマウスカーソルを使いたい場合は３の設定をします。必要なければ４に進んでください[[BR]]
 3. 設定→デバイス→マウス→「その他のマウスオプション」(これはコントロールパネルのマウスのプロパティと同じ設定画面です)の、ポインタータブで、好みのカーソル形状、大きさに設定します[[BR]]
 4. タスクトレイのFlushMouseのアイコンをクリックして設定を選択し、「マウスカーソルのサイズ」を好みの大きさに設定します[[BR]]
 * FlushMouseで設定するカーソルの大きさは、アプリケーション独自に表示するもの(例えばExcelの十字型のカーソルなど)には影響しませんので、１から３を繰り返して、それらが好みの大きさになるようにしてから、FlushMouseでコントロールするカーソルの大きさを合わせると使いやすくなると思います[[BR]]
[[BR]]
'''設定項目について''' (わかりづらい項目のみ説明します)[[BR]]
[[BR]]
 * IMEモードの取得方法[[BR]]
   * 「マウスカーソル下のウィンドウのIMEモードを表示する」 / 「フォーカスウィンドウのIMEモードを表示する」から選べます[[BR]]
   * 設定→時刻と言語→言語→キーボードの「入力方式の切り替え」や、旧IMEのプロパティにある「IME入力モード切替の通知の画面中央に表示する」と関わってきますので、ご自分の設定に合わせて好みな方を選択してください[[BR]]
 * IME関連キーが押されたときにIMEモードを表示する[[BR]]
   * IME関連キーとは「半角/全角(漢字)」「変換」「無変換」「カタカナ/ひらがな」「Ctrl + F6〜F9」などを指します[[BR]]
 * モード表示の時間[[BR]]
   * マウスカーソルの左に「あ」「ア」「Ａ」「_ｱ」「_A」を表示をしている時間を調整できます[[BR]]
 * Ctrlキーを離してからモードを表示するまでの時間[[BR]]
   * 設定の「マウスのプロパティ」にある、「Ctrlキーを押すとポインターの位置を表示する」をONにしているとき、この表示と重なるのを避けるためにモードを表示するまでの時間を調整できます[[BR]]
 * IMEモードをキャレット(テキストカーソル)の左に表示する
   * アプリによってはキャレットの位置が取得できなかったり、表示位置がおかしくなることがあります(これは制限事項となります)。ただし、位置が取得できない場合は、マウスカーソルの左に表示します[[BR]]
 * 本FlushMouseでは、「矢印」「Ｉビーム」「ハンド」を 「aero_」から抽出したものを表示しています(これは固定になります。ご了承ください)[[BR]]
[[BR]]
'''β機能　ExplorerPatcher Simple Window Switcher Helper について''' [[BR]]
[[BR]]
　まず、ExplorerPatcher ([https://github.com/valinet]) の作者であるValentin-Gabrielに謝意を伝えます　Thanks, Valentin-Gabriel ! [[BR]]
[[BR]]
　さて、マルチモニターの環境でSimple Window Switcherを有効にすると、Alt + Tabでマウスカーソルのあるカレントモニターのウィンドウだけを切り替えられて非常に便利です。もちろん他にも便利な機能があります[[BR]]
[[BR]]
　しかし、Valinetのブログ([https://valinet.ro/2021/11/18/Functional-Windows-10-flyouts-on-Windows-11.html])を読むとわかるのですが、英語キーボード(101/102/104キーボード)のドライバーをロードして実現しています。このため、日本語キーボード(106/109)メインの我々にはちょっと困ったことになってしまいます。例えば、漢字(半角/全角)キーで「 !` 」が入力されてしまったり、「@」マークなどの記号の位置が変わってしまったり。何より日本語変換ができません。そこで、FlushMouseに、強制的にUS / ENGを排除する機能を加えました[[BR]]
　IME関連キー押したときやマウスクリックしたとき、フォーカスが切り替わったときなどにIMEの状態をチェックして、後述するように動作します[[BR]]
[[BR]]
　ただし、以下のような制限事項があります[[BR]]
[[BR]]
 * ★__物理的に英語(101/102/104)キーボードを接続している場合は動きません。必ず日本語(106/109)キーボードの環境で使用してください__ [[BR]]
　　　(日本語キーボードが見つからないときには、本機能が動作しないようにチェックしています)[[BR]]
 * ★Windowsに付属されているMicrosoftのIMEでしか検証していません[[BR]]
 * 一部のアプリケーションでは「漢字(半角/全角)」などのIME関連キーで「US / ENG」「JA / ENG」から切り替わらないことがあります。現時点では制限事項となります。ご了承ください[[BR]]
 
[[BR]]
 * IME関連キーの動作は下記のようになります(IMEの設定でキーマップを変更している場合は異なることがあります)[[BR]]
   * FlushMouse 動作時[[BR]]
||↓押下キー　　　IMEの状態→||　　JA / IME 　　||　　JA / ENG 　　||　　US / ENG 　　||
||半角 / 全角 (漢字) 　　　　||　　 あ / A　　　||(前のIME ON状態) ||(前のIME ON状態) ||
||無変換 　　　　　　　　　　||　　 IME OFF 　　||　　 IME OFF 　　||　　 IME OFF 　　||
||無変換 (IME ONの状態から)　||　あ / ア / _ｱ 　||(前のIME ON状態) ||(前のIME ON状態) ||
||変換 　　　　　　　　　　　||(前のIME ON状態) ||(前のIME ON状態) ||(前のIME ON状態) ||
||ひらがな 　　　　　　　　　||　　　 あ　　　　||(前のIME ON状態) ||(前のIME ON状態) ||
||カタカナ (Shift + ひらがな)||　　　 カ　　　　||(前のIME ON状態) ||(前のIME ON状態) ||
||英数 　　　　　　　　　　　||　　　 A 　　　　||(前のIME ON状態) ||(前のIME ON状態) ||
      * JA / IME の時は、英数、ひらがな、カタカナ(Shift + ひらがな)のみコントロールしています。その他は,Windowsのデフォルトの動作です (以前のバージョンの IMEを使用してキーマップを変更すると使いやすくなると思います)[[BR]]
    * Windowsのデフォルト(参考)[[BR]]
||↓押下キー　　　IMEの状態→||　　JA / IME 　　||　　JA / ENG 　　||　　US / ENG 　　||
||半角 / 全角 (漢字) 　　　　||　　 あ / A　　　||　　　 −　　　　|| 「 !` 」の入力  ||
||無変換 　　　　　　　　　　||　　　 −　　　　||　　　 −　　　　||　　　 −　　　　||
||無変換 (IME ONの状態から)　||　あ / ア / _ｱ 　||　　　 −　　　　||　　　 −　　　　||
||変換 　　　　　　　　　　　||(前のIME ON状態) ||　　　 −　　　　||　　　 −　　　　||
||ひらがな 　　　　　　　　　||　　 あ / カ 　　||　　　 −　　　　||　　　 −　　　　||
||カタカナ (Shift + ひらがな)||あ(もう一度で カ)||　　　 −　　　　||　　　 −　　　　||
||英数 　　　　　　　　　　　||　　 あ / A　　　||　　　 −　　　　||　　　 −　　　　||



== リリースファイル (Release Files)
[[ReleaseList]]

== 最近のコミット (Recent Commits)
[[RecentCommit]]

[[RepositoryReadme]]

== 最近更新されたチケット (Latest updated Tickets)
[[RecentTickets(limit=5)]]

= 作業部屋 Wiki について

OSDN Wiki システムへようこそ。ここは作業部屋用の Wiki ページです。

ほぼプロジェクトと同じ機能が使えます。書式などに関しては、[wiki:docs:WikiGuide Wikiガイド]を参照して下さい。

= About Chamber Wiki

Welcome to OSDN Wiki system. Here is your chamber Wiki space.

Check [wiki:docs-en:WikiGuide Wiki Guide (English)] to refer syntax and functions.




